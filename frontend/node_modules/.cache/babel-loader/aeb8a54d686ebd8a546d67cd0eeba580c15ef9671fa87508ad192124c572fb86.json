{"ast":null,"code":"import React,{useState}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function UploadGameForm(_ref){let{auth,onClose,onUploaded}=_ref;const[title,setTitle]=useState('');const[price,setPrice]=useState('');const[description,setDescription]=useState('');const[imageFile,setImageFile]=useState(null);const[gameFile,setGameFile]=useState(null);console.log('üîë Token dispon√≠vel no form:',auth===null||auth===void 0?void 0:auth.token);const handleSubmit=async e=>{e.preventDefault();if(!auth||!auth.token){alert('Token de autentica√ß√£o n√£o encontrado!');return;}const formData=new FormData();formData.append('title',title);formData.append('price',price);formData.append('description',description);if(imageFile)formData.append('image',imageFile);// üîë Exatamente como no backend!\nif(gameFile)formData.append('gameFile',gameFile);// üîë Exatamente como no backend!\n// ‚úÖ Inspeciona o que vai ser enviado\nconsole.log('‚û°Ô∏è Conte√∫do do formData:');for(let pair of formData.entries()){console.log(`${pair[0]}:`,pair[1]);}try{const res=await fetch('http://localhost:5000/games/upload',{method:'POST',headers:{Authorization:`Bearer ${auth.token}`// ‚úÖ Apenas o token vai no header!\n},body:formData// ‚úÖ Nunca coloque 'Content-Type' no header com FormData!\n});// ‚úÖ Tenta converter a resposta em JSON com seguran√ßa\nlet data;try{data=await res.json();}catch(jsonError){console.error('‚ùå Erro ao converter a resposta em JSON:',jsonError);alert('Erro no servidor. Tente novamente mais tarde!');return;// üî• Impede que o c√≥digo abaixo execute se der erro\n}if(res.ok){alert(data.message||'Jogo enviado com sucesso!');onUploaded();// Atualiza a lista no Dashboard\nonClose();// Fecha o modal/formul√°rio\n}else{console.error('‚ùå Erro no envio:',data.error);alert(data.error||'Erro ao enviar o jogo!');}}catch(err){console.error('‚ùå Erro de rede ou servidor caiu:',err);alert('Erro de conex√£o com o servidor!');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-900 text-white p-6 rounded-xl shadow-lg w-full max-w-2xl mx-auto mt-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-purple-500 mb-4 text-center\",children:\"Enviar Novo Jogo \\uD83D\\uDE80\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-purple-400 mb-1\",children:\"T\\xEDtulo:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:title,onChange:e=>setTitle(e.target.value),required:true,className:\"w-full p-2 rounded bg-gray-800 border border-purple-500\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-purple-400 mb-1\",children:\"Pre\\xE7o (R$):\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:price,onChange:e=>setPrice(e.target.value),required:true,className:\"w-full p-2 rounded bg-gray-800 border border-purple-500\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-purple-400 mb-1\",children:\"Descri\\xE7\\xE3o:\"}),/*#__PURE__*/_jsx(\"textarea\",{value:description,onChange:e=>setDescription(e.target.value),required:true,className:\"w-full p-2 rounded bg-gray-800 border border-purple-500\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-purple-400 mb-1\",children:\"Imagem do Jogo (PNG/JPG):\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:e=>setImageFile(e.target.files[0]),required:true,className:\"w-full p-2 rounded bg-gray-800 border border-purple-500\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-purple-400 mb-1\",children:\"Arquivo do Jogo (ZIP, RAR ou EXE):\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\".zip,.rar,.exe\",onChange:e=>setGameFile(e.target.files[0]),required:true,className:\"w-full p-2 rounded bg-gray-800 border border-purple-500\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between mt-6\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded\",children:\"Enviar\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:onClose,className:\"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded\",children:\"Cancelar\"})]})]})]});}export default UploadGameForm;","map":{"version":3,"names":["React","useState","jsx","_jsx","jsxs","_jsxs","UploadGameForm","_ref","auth","onClose","onUploaded","title","setTitle","price","setPrice","description","setDescription","imageFile","setImageFile","gameFile","setGameFile","console","log","token","handleSubmit","e","preventDefault","alert","formData","FormData","append","pair","entries","res","fetch","method","headers","Authorization","body","data","json","jsonError","error","ok","message","err","className","children","onSubmit","type","value","onChange","target","required","accept","files","onClick"],"sources":["C:/gamehive-tailwind/gamehive-tailwind/frontend/src/components/UploadGameForm/UploadGameForm.js"],"sourcesContent":["import React, { useState } from 'react';\r\n\r\nfunction UploadGameForm({ auth, onClose, onUploaded }) {\r\n  const [title, setTitle] = useState('');\r\n  const [price, setPrice] = useState('');\r\n  const [description, setDescription] = useState('');\r\n  const [imageFile, setImageFile] = useState(null);\r\n  const [gameFile, setGameFile] = useState(null);\r\n\r\n  console.log('üîë Token dispon√≠vel no form:', auth?.token);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n  \r\n    if (!auth || !auth.token) {\r\n      alert('Token de autentica√ß√£o n√£o encontrado!');\r\n      return;\r\n    }\r\n  \r\n    const formData = new FormData();\r\n    formData.append('title', title);\r\n    formData.append('price', price);\r\n    formData.append('description', description);\r\n    if (imageFile) formData.append('image', imageFile);        // üîë Exatamente como no backend!\r\n    if (gameFile) formData.append('gameFile', gameFile);        // üîë Exatamente como no backend!\r\n  \r\n    // ‚úÖ Inspeciona o que vai ser enviado\r\n    console.log('‚û°Ô∏è Conte√∫do do formData:');\r\n    for (let pair of formData.entries()) {\r\n      console.log(`${pair[0]}:`, pair[1]);\r\n    }\r\n  \r\n    try {\r\n      const res = await fetch('http://localhost:5000/games/upload', {\r\n        method: 'POST',\r\n        headers: {\r\n          Authorization: `Bearer ${auth.token}`, // ‚úÖ Apenas o token vai no header!\r\n        },\r\n        body: formData, // ‚úÖ Nunca coloque 'Content-Type' no header com FormData!\r\n      });\r\n  \r\n      // ‚úÖ Tenta converter a resposta em JSON com seguran√ßa\r\n      let data;\r\n      try {\r\n        data = await res.json();\r\n      } catch (jsonError) {\r\n        console.error('‚ùå Erro ao converter a resposta em JSON:', jsonError);\r\n        alert('Erro no servidor. Tente novamente mais tarde!');\r\n        return; // üî• Impede que o c√≥digo abaixo execute se der erro\r\n      }\r\n  \r\n      if (res.ok) {\r\n        alert(data.message || 'Jogo enviado com sucesso!');\r\n        onUploaded(); // Atualiza a lista no Dashboard\r\n        onClose();    // Fecha o modal/formul√°rio\r\n      } else {\r\n        console.error('‚ùå Erro no envio:', data.error);\r\n        alert(data.error || 'Erro ao enviar o jogo!');\r\n      }\r\n  \r\n    } catch (err) {\r\n      console.error('‚ùå Erro de rede ou servidor caiu:', err);\r\n      alert('Erro de conex√£o com o servidor!');\r\n    }\r\n  };\r\n  \r\n\r\n  return (\r\n    <div className=\"bg-gray-900 text-white p-6 rounded-xl shadow-lg w-full max-w-2xl mx-auto mt-8\">\r\n      <h2 className=\"text-2xl font-bold text-purple-500 mb-4 text-center\">Enviar Novo Jogo üöÄ</h2>\r\n\r\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n        {/* T√çTULO */}\r\n        <div>\r\n          <label className=\"block text-purple-400 mb-1\">T√≠tulo:</label>\r\n          <input\r\n            type=\"text\"\r\n            value={title}\r\n            onChange={(e) => setTitle(e.target.value)}\r\n            required\r\n            className=\"w-full p-2 rounded bg-gray-800 border border-purple-500\"\r\n          />\r\n        </div>\r\n\r\n        {/* PRE√áO */}\r\n        <div>\r\n          <label className=\"block text-purple-400 mb-1\">Pre√ßo (R$):</label>\r\n          <input\r\n            type=\"number\"\r\n            value={price}\r\n            onChange={(e) => setPrice(e.target.value)}\r\n            required\r\n            className=\"w-full p-2 rounded bg-gray-800 border border-purple-500\"\r\n          />\r\n        </div>\r\n\r\n        {/* DESCRI√á√ÉO */}\r\n        <div>\r\n          <label className=\"block text-purple-400 mb-1\">Descri√ß√£o:</label>\r\n          <textarea\r\n            value={description}\r\n            onChange={(e) => setDescription(e.target.value)}\r\n            required\r\n            className=\"w-full p-2 rounded bg-gray-800 border border-purple-500\"\r\n          />\r\n        </div>\r\n\r\n        {/* IMAGEM */}\r\n        <div>\r\n          <label className=\"block text-purple-400 mb-1\">Imagem do Jogo (PNG/JPG):</label>\r\n          <input\r\n            type=\"file\"\r\n            accept=\"image/*\"\r\n            onChange={(e) => setImageFile(e.target.files[0])}\r\n            required\r\n            className=\"w-full p-2 rounded bg-gray-800 border border-purple-500\"\r\n          />\r\n        </div>\r\n\r\n        {/* ARQUIVO DO JOGO */}\r\n        <div>\r\n          <label className=\"block text-purple-400 mb-1\">Arquivo do Jogo (ZIP, RAR ou EXE):</label>\r\n          <input\r\n            type=\"file\"\r\n            accept=\".zip,.rar,.exe\"\r\n            onChange={(e) => setGameFile(e.target.files[0])}\r\n            required\r\n            className=\"w-full p-2 rounded bg-gray-800 border border-purple-500\"\r\n          />\r\n        </div>\r\n\r\n        {/* BOT√ïES */}\r\n        <div className=\"flex justify-between mt-6\">\r\n          <button\r\n            type=\"submit\"\r\n            className=\"bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded\"\r\n          >\r\n            Enviar\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            onClick={onClose}\r\n            className=\"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded\"\r\n          >\r\n            Cancelar\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default UploadGameForm;\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}